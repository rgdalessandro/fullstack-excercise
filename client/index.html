<html>
<head>
  <title>GitHub Fetcher</title>
</head>
<body>

<h2>GitHub Fetcher</h2>
<form class="repo-fetcher">
  <h3>Enter a GitHub username to fetch:</h3>
  <input type="text" name="username" id="username"/>

  <button type="submit">Fetch User's Repos</button>
</form>

<table class="top-repos"></table>

<script src="https://code.jquery.com/jquery-2.2.0.js"></script>
<script>

//
// TODO:
//  Respond to the form's `submit` event,
//  fetch from GitHub's API,
//  and send result to POST /repos/import
//
$('.repo-fetcher').on('submit', function(e){
  e.preventDefault();
  var user = $('#username').val();
  var repos;
  $.getJSON(`https://api.github.com/users/${user}/repos`)
  .then(function(json){
    $('#username').val('');
    repos = json;                 
    console.log('user:', user, 'repos:', repos);
    return repos;
  })
  .then(function(repos){
    $.ajax({
      type: "POST",
      url: '/repos/import',
      contentType: 'application/json',
      dataType: 'json',
      data: JSON.stringify({repositories: repos})
    })
  });
})

</script>
</body>
</html>